require=function e(t,n,o){function i(c,s){if(!n[c]){if(!t[c]){var a="function"==typeof require&&require;if(!s&&a)return a(c,!0);if(r)return r(c,!0);var l=new Error("Cannot find module '"+c+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[c]={exports:{}};t[c][0].call(u.exports,function(e){var n=t[c][1][e];return i(n?n:e)},u,u.exports,e,t,n,o)}return n[c].exports}for(var r="function"==typeof require&&require,c=0;c<o.length;c++)i(o[c]);return i}({"drop-pick-control":[function(e,t,n){"use strict";cc._RFpush(t,"d9096LhHTJBFbyIu7H7IUz2","drop-pick-control"),cc.Class({"extends":cc.Component,properties:{_touchEnemy:null,_pickedEnemy:null},onLoad:function(){var e=cc.director.getCollisionManager();e.enabled=!0,cc.systemEvent.on("keyup",this.onKeyUp,this),this.node.zIndex=1e3},onCollisionEnter:function(e,t){"enemy"==e.node.group&&this.onTouchEnemy(e,t)},onCollisionExit:function(e,t){"enemy"==e.node.group&&this.onLeaveEnemy(e,t)},onTouchEnemy:function(e,t){e.node.getComponent("enemy-control").touch(this)},onLeaveEnemy:function(e,t){e.node.getComponent("enemy-control").leave(this)},onKeyUp:function(e){e.keyCode==cc.KEY.space&&this.onSpaceUp()},onSpaceUp:function(){this._pickedEnemy&&this._pickedEnemy.getComponent("enemy-control").drop(this),this._touchEnemy&&this._touchEnemy.getComponent("enemy-control").pick(this)}}),cc._RFpop()},{}],"enemy-control":[function(e,t,n){"use strict";cc._RFpush(t,"3508drOR35OGZvIQGJ2q/6L","enemy-control"),cc.Class({"extends":cc.Component,properties:{movePixel:60,_startPosition:null,_dirVector:null,_fsm:null,sleepDuration:5e3,_sleepTimeStamp:null,_player:null},init:function(t){this._player=t,this.node.zIndex=100;var n=cc.director.getCollisionManager();n.enabled=!0,this._sleepTimeStamp=Date.now(),this._fsm=e("enemy-fsm").create(),this._fsm.startup()},onCollisionEnter:function(e,t){if("wall"==e.node.group&&this.onTouchWall(),"enemy"==e.node.group){var n=e.node.getComponent("enemy-control"),o=t.node.getComponent("enemy-control");"following"==n._fsm.current&&"throwing"==o._fsm.current&&(n._sleepTimeStamp=Date.now(),n._fsm.sleep(),o._sleepTimeStamp=Date.now(),o._fsm.sleep(),this.node.position=this._startPosition,window.score+=100)}if("player"==e.node.group){var i=t.node.getComponent("enemy-control");"following"==i._fsm.current&&(window.sceneLoad||(window.sceneLoad=!0,cc.director.loadScene("game-over-scene")))}},onTouchWall:function(){this._sleepTimeStamp=Date.now(),this._fsm.sleep()},pick:function(e){"sleeping"==this._fsm.current&&(e._pickedEnemy=this.node,this.node.getChildByName("sleep-rest-duration").getComponent(cc.Label).string="",this.node.removeFromParent(!1),this._fsm.pick())},drop:function(e){e._pickedEnemy=null;var t=cc.find("Canvas");t.addChild(this.node),this.node.position=e.node.position,this.node.zIndex=100,this._sleepTimeStamp=Date.now(),this._fsm.sleep()},touch:function(e){e._touchEnemy=this.node},leave:function(e){e._touchEnemy==this.node&&(e._touchEnemy=null)},"throw":function(e,t,n){n._pickedEnemy=null,this._startPosition=e,this._dirVector=t;var o=cc.find("Canvas");o.addChild(this.node),this.node.position=this._startPosition,this.node.zIndex=100,this._fsm["throw"]()},lateUpdate:function(){if("throwing"==this._fsm.current)this.node.position=cc.pAdd(this.node.position,cc.pMult(this._dirVector,10*this.movePixel));else if("sleeping"==this._fsm.current)if(Date.now()-this._sleepTimeStamp>this.sleepDuration)this.node.getChildByName("sleep-rest-duration").getComponent(cc.Label).string="",this._fsm.follow();else{var e=Math.ceil((this.sleepDuration+this._sleepTimeStamp-Date.now())/1e3);this.node.getChildByName("sleep-rest-duration").getComponent(cc.Label).string=e}else if("following"==this._fsm.current){var t=cc.pNormalize(cc.pSub(this._player.position,this.node.position));this.node.position=cc.pAdd(this.node.position,cc.pMult(t,this.movePixel))}}}),cc._RFpop()},{"enemy-fsm":"enemy-fsm"}],"enemy-fsm":[function(e,t,n){"use strict";cc._RFpush(t,"2cce2X+0SVI9ZJ5EUtVvYVg","enemy-fsm");var o=e("state-machine"),i={initial:"nope",events:[{name:"startup",from:"nope",to:"sleeping"},{name:"pick",from:"sleeping",to:"picking"},{name:"sleep",from:"picking",to:"sleeping"},{name:"sleep",from:"following",to:"sleeping"},{name:"sleep",from:"throwing",to:"sleeping"},{name:"follow",from:"sleeping",to:"following"},{name:"throw",from:"picking",to:"throwing"}]},r=function(){var e=o.create(i);return e.ASYNC=o.ASYNC,e};t.exports={create:r},cc._RFpop()},{"state-machine":"state-machine"}],"enemy-generator":[function(e,t,n){"use strict";cc._RFpush(t,"8c120UEmmdAPLejJtmN4HZG","enemy-generator"),cc.Class({"extends":cc.Component,properties:{enemyPrefabArray:[cc.Prefab],player:cc.Node,generateDeltaDuration:12,generateTimes:10},onLoad:function(){window.score=0,window.sceneLoad=!1,this.generator(),this.schedule(this.generator,this.generateDeltaDuration,this.generateTimes)},generator:function(){var e=this.enemyPrefabArray.length,t=Math.floor(Math.random()*e),n=cc.instantiate(this.enemyPrefabArray[t]);cc.find("Canvas").addChild(n);var o=null,i=Math.sign(cc.randomMinus1To1());0==i&&(i=1),o=Math.random()>=.5?cc.v2(417*cc.randomMinus1To1(),260*i):cc.v2(417*i,260*cc.randomMinus1To1()),n.getComponent("enemy-control").init(this.player),n.position=o}}),cc._RFpop()},{}],"move-control":[function(e,t,n){"use strict";cc._RFpush(t,"1177fsJljJFH7wVQlI+culU","move-control"),cc.Class({"extends":cc.Component,properties:{_left:!1,_right:!1,_up:!1,_down:!1,movePixel:80,_leftBlock:!1,_rightBlock:!1,_upBlock:!1,_downBlock:!1},onLoad:function(){var e=cc.director.getCollisionManager();e.enabled=!0,cc.systemEvent.on("keydown",this.onKeyDown,this),cc.systemEvent.on("keyup",this.onKeyUp,this)},onKeyDown:function(e){switch(e.keyCode){case cc.KEY.w:this._up=!0;break;case cc.KEY.s:this._down=!0;break;case cc.KEY.a:this._left=!0;break;case cc.KEY.d:this._right=!0}},onKeyUp:function(e){switch(e.keyCode){case cc.KEY.w:this._up=!1;break;case cc.KEY.s:this._down=!1;break;case cc.KEY.a:this._left=!1;break;case cc.KEY.d:this._right=!1}},onCollisionEnter:function(e,t){"wall"==e.node.group&&this.onTouchWall(e,t)},onCollisionExit:function(e,t){"wall"==e.node.group&&this.onLeaveWall(e,t)},onTouchWall:function(e,t){var n=e.node.name,o=n.split("-")[0],i="_"+o+"Block";this[i]=!0},onLeaveWall:function(e,t){var n=e.node.name,o=n.split("-")[0],i="_"+o+"Block";this[i]=!1},lateUpdate:function(){var e=cc.v2(0,0);this._left&&!this._leftBlock&&(e.x-=this.movePixel),this._right&&!this._rightBlock&&(e.x+=this.movePixel),this._up&&!this._upBlock&&(e.y+=this.movePixel),this._down&&!this._downBlock&&(e.y-=this.movePixel),this.node.position=cc.pAdd(this.node.position,e)}}),cc._RFpop()},{}],restart:[function(e,t,n){"use strict";cc._RFpush(t,"6b08dUBdd9Lw7N0apYCAVii","restart"),cc.Class({"extends":cc.Component,properties:{scoreLabel:cc.Label},onLoad:function(){this.node.on("touchstart",this.restart.bind(this)),this.scoreLabel.string="your score: "+window.score},restart:function(){cc.director.loadScene("main-scene")},onDestroy:function(){this.node.off("touchstart",this.restart.bind(this))}}),cc._RFpop()},{}],"state-machine":[function(e,t,n){"use strict";cc._RFpush(t,"e2777euF5JDgpc+pO8YYIyN","state-machine"),function(){var e={VERSION:"2.4.0",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(t,n){var o="string"==typeof t.initial?{state:t.initial}:t.initial,i=t.terminal||t["final"],r=n||t.target||{},c=t.events||[],s=t.callbacks||{},a={},l={},u=function(t){var n=Array.isArray(t.from)?t.from:t.from?[t.from]:[e.WILDCARD];a[t.name]=a[t.name]||{};for(var o=0;o<n.length;o++)l[n[o]]=l[n[o]]||[],l[n[o]].push(t.name),a[t.name][n[o]]=t.to||n[o];t.to&&(l[t.to]=l[t.to]||[])};o&&(o.event=o.event||"startup",u({name:o.event,from:"none",to:o.state}));for(var h=0;h<c.length;h++)u(c[h]);for(var p in a)a.hasOwnProperty(p)&&(r[p]=e.buildEvent(p,a[p]));for(var p in s)s.hasOwnProperty(p)&&(r[p]=s[p]);return r.current="none",r.is=function(e){return Array.isArray(e)?e.indexOf(this.current)>=0:this.current===e},r.can=function(t){return!this.transition&&void 0!==a[t]&&(a[t].hasOwnProperty(this.current)||a[t].hasOwnProperty(e.WILDCARD))},r.cannot=function(e){return!this.can(e)},r.transitions=function(){return(l[this.current]||[]).concat(l[e.WILDCARD]||[])},r.isFinished=function(){return this.is(i)},r.error=t.error||function(e,t,n,o,i,r,c){throw c||r},r.states=function(){return Object.keys(l).sort()},o&&!o.defer&&r[o.event](),r},doCallback:function(t,n,o,i,r,c){if(n)try{return n.apply(t,[o,i,r].concat(c))}catch(s){return t.error(o,i,r,c,e.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",s)}},beforeAnyEvent:function(t,n,o,i,r){return e.doCallback(t,t.onbeforeevent,n,o,i,r)},afterAnyEvent:function(t,n,o,i,r){return e.doCallback(t,t.onafterevent||t.onevent,n,o,i,r)},leaveAnyState:function(t,n,o,i,r){return e.doCallback(t,t.onleavestate,n,o,i,r)},enterAnyState:function(t,n,o,i,r){return e.doCallback(t,t.onenterstate||t.onstate,n,o,i,r)},changeState:function(t,n,o,i,r){return e.doCallback(t,t.onchangestate,n,o,i,r)},beforeThisEvent:function(t,n,o,i,r){return e.doCallback(t,t["onbefore"+n],n,o,i,r)},afterThisEvent:function(t,n,o,i,r){return e.doCallback(t,t["onafter"+n]||t["on"+n],n,o,i,r)},leaveThisState:function(t,n,o,i,r){return e.doCallback(t,t["onleave"+o],n,o,i,r)},enterThisState:function(t,n,o,i,r){return e.doCallback(t,t["onenter"+i]||t["on"+i],n,o,i,r)},beforeEvent:function(t,n,o,i,r){if(!1===e.beforeThisEvent(t,n,o,i,r)||!1===e.beforeAnyEvent(t,n,o,i,r))return!1},afterEvent:function(t,n,o,i,r){e.afterThisEvent(t,n,o,i,r),e.afterAnyEvent(t,n,o,i,r)},leaveState:function(t,n,o,i,r){var c=e.leaveThisState(t,n,o,i,r),s=e.leaveAnyState(t,n,o,i,r);return!1!==c&&!1!==s&&(e.ASYNC===c||e.ASYNC===s?e.ASYNC:void 0)},enterState:function(t,n,o,i,r){e.enterThisState(t,n,o,i,r),e.enterAnyState(t,n,o,i,r)},buildEvent:function(t,n){return function(){var o=this.current,i=n[o]||(n[e.WILDCARD]!=e.WILDCARD?n[e.WILDCARD]:o)||o,r=Array.prototype.slice.call(arguments);if(this.transition)return this.error(t,o,i,r,e.Error.PENDING_TRANSITION,"event "+t+" inappropriate because previous transition did not complete");if(this.cannot(t))return this.error(t,o,i,r,e.Error.INVALID_TRANSITION,"event "+t+" inappropriate in current state "+this.current);if(!1===e.beforeEvent(this,t,o,i,r))return e.Result.CANCELLED;if(o===i)return e.afterEvent(this,t,o,i,r),e.Result.NOTRANSITION;var c=this;this.transition=function(){return c.transition=null,c.current=i,e.enterState(c,t,o,i,r),e.changeState(c,t,o,i,r),e.afterEvent(c,t,o,i,r),e.Result.SUCCEEDED},this.transition.cancel=function(){c.transition=null,e.afterEvent(c,t,o,i,r)};var s=e.leaveState(this,t,o,i,r);return!1===s?(this.transition=null,e.Result.CANCELLED):e.ASYNC===s?e.Result.PENDING:this.transition?this.transition():void 0}}};"undefined"!=typeof n?("undefined"!=typeof t&&t.exports&&(n=t.exports=e),n.StateMachine=e):"function"==typeof define&&define.amd?define(function(t){return e}):"undefined"!=typeof window?window.StateMachine=e:"undefined"!=typeof self&&(self.StateMachine=e)}(),cc._RFpop()},{}],"throw-control":[function(e,t,n){"use strict";cc._RFpush(t,"ea3f8DmOMNHM72xjYkh93ku","throw-control"),cc.Class({"extends":cc.Component,properties:{_dropPickControl:{get:function(){return this.getComponent("drop-pick-control")}}},onLoad:function(){cc.find("Canvas").on("mouseup",this.onMouseUp,this)},onMouseUp:function(e){if(this._dropPickControl._pickedEnemy){var t=this.node.position,n=cc.pNormalize(this.node.convertToNodeSpaceAR(e.getLocation())),o=this._dropPickControl;this._dropPickControl._pickedEnemy.getComponent("enemy-control")["throw"](t,n,o)}}}),cc._RFpop()},{}]},{},["enemy-fsm","state-machine","drop-pick-control","enemy-control","enemy-generator","move-control","restart","throw-control"]);